# 餐饮小程序API文档

[TOC]

## 版本
- 小程序基本接口 ————20180622 mambaji
- 登录验证接口 wxlogin ————20180626 16:56 mambaji
- 新增用户token验证接口 ————20180627 10:36 mambaji
- 更新商品信息、商品属性接口、收货地址、商户信息 ————20180704 11:43 mambaji
- 登录验证，获取token接口需要返回openId，支付时候需要用到 ————20180705 10：20 mambaji
- 预约接口更新、订单列表、订单详情接口，差提交订单接口 ————20180719 13：12 mambaji

## 登录验证
### 1.发送code换取sessionKey（完成）

接口地址：/wechat/hxcy/auth/wxlogin

请求方式：POST

请求参数：


| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| code| String|微信登录code| y|


返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| token| String| token存放在本地，过期需要重新调用该接口获取|
| fOpenId|String|用户的openId，支付时候需要用到openId|
| fCustId| int | 客户id|

### 2.检查token是否过期（完成）

接口地址：/wechat/hxcy/auth/token

请求方式：POST

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| token| String|用户token| y|

返回参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| | || |


## 商户信息
### 1. 获取商户基本信息（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| shopId| int|商户唯一识别Id| y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| name| String|商户名称|
| address|String|商户地址|
| bossId|int|业主ID|
|phone|String|联系电话|
|email|String|邮箱|
|addressX|String|经度|
|addressY|String|纬度|
|imgPath1|String|图片1|
|imgPath2|String|图片2|
|imgPath3|String|图片3|
|imgPath4|String|图片4|
|imgPath5|String|图片5|
|imgPath6|String|图片6|
|vidPath|String|视频链接|
|openTime|String|营业时间|
|startPrice|String|起送价|
|packPrice|String|包装费|
|distributionPrice|String|配送费|
|notice|String|商户公告|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{
			name:'亿都拉面',
			address:'广东省汕头市',
			bossId:'001',
			phone:'15918881632',
			email:'mambaji@163.com',
			addressX:'3.235',
			addressY:'3.2556',
			imgPath1:'',
			imgPath2:'',
			imgPath3:'',
			imgPath4:'',
			imgPath5:'',
			imgPath6:'',
			vidPath:'',
			openTime:'09:00-22:00',
			startPrice:'20',
			packPrice:'1',
			distributionPrice:'3',
			notice:'漏发筷子请通知我们'
		}
		"msg":"success"
	}
```

## 用户基本信息

### 1. 用户信息(暂时不需要)

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| openId| String|微信openId| y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fId|int|标识Customer|
| wxUserInfo| String|微信用户信息字典|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

### 2. 用户地址查询（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fCustId| int|唯一识别ID| y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| address|String|收货地址|
| provinceId|String|省份ID|y|
| cityId|String|城市ID|y|
| areaId|String|县区ID|y|
| addressX| String|经度|
| addressY| String|纬度|
| phone| String|收货电话|
| name| String|收货人姓名|
| custId|int|对应的微信ID|
| isDefault|int|是否默认 1:是  0：否|y|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":[
			{
				address:'广厦街道第二附属医院',
				provinceId:'101',
				cityId:'10101',
				areaId:'1010101',
				addressX:'3.332',
				addressY:'3.523',
				phone:'15918881632',
				name:'纪先生',
				custId:1,
				isDefault:1,
			},{
				address:'广厦街道嘉顿小镇',
				....
			}
		]
		"msg":"success"
	}
```

### 2. 用户地址增加（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| provinceId|String|省份ID|y|
| cityId|String|城市ID|y|
| areaId|String|县区ID|y|
| address|String|收货地址|y|
| addressX| String|经度|y|
| addressY| String|纬度|y|
| phone| String|收货电话|y|
| name| String|收货人姓名|y|
| custId|int|客户ID|y|
| isDefault|int|是否默认|y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

### 2. 用户地址修改(完成)

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fId| int|唯一识别ID| y|
| address|String|收货地址|y|
| provinceId|String|省份ID|y|
| cityId|String|城市ID|y|
| areaId|String|县区ID|y|
| addressX| String|经度|y|
| addressY| String|纬度|y|
| phone| String|收货电话|y|
| name| String|收货人姓名|y|
| custId|int|客户ID|y|
| isDefault|int|是否默认|y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

##预约

### 1. 商户预约表单信息（废除）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| shopId| String|商户Id| y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| text1|String|文本1|
| text2|String|文本2|
| text3|String|文本3|
| text4|String|文本4|
| text5|String|文本5|
| text6|String|文本6|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

### 2. 用户提交预约表单信息（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fShopId| int| 商户ID|y|
| fDate|String|申请日期|n|
| fDateTime|String|预约时间|n|
| fPhone|String|电话号码|n|
| fCustName|String|联系人|N|
| fPeopleNum|String|人数|N|
| fTableNum|String|桌号|N|
| fCustId| int|客户id|Y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

### 3. 获取预约记录（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fCustId|int|客户Id|Y|
| fShopId| int| 商户ID|Y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fDate|String|申请日期|
| fDateTime|String|预约时间|
| fPhone|String|电话号码|
| fCustName|String|联系人|
| fPeopleNum|String|人数|
| fTableNum|String|桌号|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

## 商品信息

### 1. 分类信息（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fShopId| int|商户Id|Y |


返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fListId| int|分类唯一ID|
| fListName| String|分类名称|
| fNote| String|分类备注|
| fListNum| int|排序ID|
| fParent| int|父级|
| fLevel| int|级别|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":[
			0:{
				"fListId":
				"fListName":
				"fListNum":
				"fNote":
				"fParent":
				"fLevel":
				"child":[
					0:{
						"fListId":
						"fListName":
						"fListNum":
						"fNote":
						"fParent":
						"fLevel":
						"child":[
						]
					},
					1:{
						"fListId":
						"fListName":
						"fListNum":
						"fNote":
						"fParent":
						"fLevel":
						"child":[
						]
					}
				]
			},
			1:{
				"fListId":
				"fListName":
				"fListNum":
				"fNote":
				"fParent":
				"fLevel":
				"child":[
				]
			}
		]
		"msg":"success"
	}
```

### 2. 商品信息（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fShopId|int|商品id|y|
| fGoodsListId| int|类别ID|N|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fGoodsListId|int|类别id|
| fGoodsMsg|array|商品信息|
| fName| String|商品名称|
| fGoodsImg| int|商品图片|
| fGoodsNote| int|商品描述|
| fBaseAmount| float|基础金额|
| fStatus| int|状态|
| fOldPrice| float|原价|
| fLable| String|标签|
| fSellNum|int|月售数量|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{
			goodsListId:'01'
			goodsMsg:[
				{
					name:'红烧牛肉面',
					goodsImg:'',
					goodsNote:'红烧牛肉面真好吃',
					baseAmount:'12',
					oldPrice:'14',
					sellNum:'205',
					lable:'',
					status:'0'
				},{
					name:'黄焖鸡米饭',
					goodsImg:'',
					goodsNote:'正宗黄焖鸡，给你惊喜的味道',
					baseAmount:'15',
					oldPrice:'20',
					sellNum:'666',
					lable:'',
					status:'0'
				}
			]
		}
		"msg":"success"
	}
```

### 2. 商品属性信息（完成）

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fGoodsId| int|商品ID|Y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fName| String|属性名称|
| fItemId|int |属性Id|
| fTypeId| int|属性类别ID|
| fTypeName| String|属性类别名称|
| fAddPrice| float|增加金额|
| fTypeNum| int|属性类别排序|
| fItemNum| int|属性排序|
| attr| array|属性信息|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{
			typeName:'大小',
			typeId:'01',
			typeNum:1,
			attr:[
				{
					name:'大份',
					itemId:'0101',
					addPrice:'2',
					itemNum:1
				},
				{
					name:'中份',
					itemId:'0102',
					addPirce:'5',
					itemNum:2
				}
			]
		}
		"msg":"success"
	}
```

## 订单管理

### 1. 提交订单

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| type| int|类型|Y|
| custId| int|根据id关联对应收获地址|N|
| baseAmount| float|基本金额|Y|
| oldPrice| float|原价|Y|
| disCount| float|折扣比|Y|
| distributionPrice| float|配送费|N|
| packPrice| float|包装费|N|
| couponId| int|优惠券ID|N|
| discountPrice| float|折扣金额|N|
| reductionPrice| float|减免金额|N|
| allAmount| float|总金额|Y|
| note| String|备注|N|
| goodsData|String|商品信息|Y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|

通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{

		}
		"msg":"success"
	}
```

### 2. 订单列表(完成)

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fShopId| int|商户Id|Y|
| fCustId| int|客户Id|Y|
| fType| int|订单类型|Y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fOrderId|int|订单ID|
| fOrderNo|String|订单号|
| fType|int|订单类型|
| fStatus |int|订单状态;0:待支付；1:已支付,待确认；2:待配送；3：配送中；4：已完成；5：已取消；6：已确认，待上菜|
| fDate | String|下单日期|
| fAllAmount |float|总金额|
| fGoodsData |String|商品信息|
| fPayType| int|付款类型|
|fTotalNum|int|订单商品总数|

goodsData内容

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fGoodsId|int|商品ID|
| fGoodsName|String|商品名称|
| fAttrName1|String|属性名称1|
| fAttrName2|String|属性名称2|
| fAttrName3|String|属性名称3|
| fAttrName4|String|属性名称4|
| fNum|int|数量|


通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{
			"fOrderId":'',
			"fOrderNo":'',
			"fType":'',
			"fStatus":'',
			"fDate":'',
			"fAllAmount":'',
			"fPayType":'',
			"fTotalNum":'',
			"fGoodsData":[
				{
					"fGoodsId":'',
					"fGoodsName":'',
					"fAttrName1":'',
					"fAttrName2":'',
					"fAttrName3":'',
					"fAttrName4":'',
					"fNum":'',
				},
				{
					"fGoodsId":'',
					"fGoodsName":'',
					"fAttrName1":'',
					"fAttrName2":'',
					"fAttrName3":'',
					"fAttrName4":'',
					"fNum":'',
				},
			]
		}
		"msg":"success"
	}
```


### 3. 订单详情(完成)

接口地址：

请求方式：

请求参数：

| 参数名 | 数据类型 | 备注 | 必传 |
| ------|----------|------|------|
| fOrderId| int|订单ID|Y|

返回参数：

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fGoodsData|String|商品详情|
| fOrderNo |String|订单编号|
| fStatus |int|订单状态|
| fDate |datetime|下单日期|
| fCustId| int|根据id关联对应收获地址|
| fBaseAmount| float|基本金额|
| fOldPrice| float|原价|Y|
| fDisCount| float|折扣比|Y|
| fDistributionPrice| float|配送费|
| fPackPrice| float|包装费|
| fCouponId| int|优惠券ID|
| fDiscountPrice| float|折扣金额|
| fReductionPrice| float|减免金额|
| fAllAmount| float|总金额|
| fNote| String|备注|

fGoodsData内容

| 参数名 | 数据类型 | 备注 |
| ------|----------|------|
| fGoodsId|int|商品ID|
| fGoodsName|String|商品名称|
| fAttrName1|String|属性名称1|
| fAttrName2|String|属性名称2|
| fAttrName3|String|属性名称3|
| fAttrName4|String|属性名称4|
| fNum|int|数量|



通用错误码：

| 错误码 | 备注 |
| ------|------|

JSON返回实例：

``` java
	{
		"code":0,
		"data":{
			"fOrderNo":'',
			"fStatus":'',
			"fDate":'',
			"fCustId":'',
			"fBaseAmount":'',
			"fOldPrice":'',
			"fDisCount":'',
			"fDistributionPrice":'',
			"fReductionPrice":'',
			"fPackPrice":'',
			"fCouponId":'',
			"fDiscountPrice":'',
			"fReductionPrice"："",
			"fAllAmount":'',
			"fNote":'',
			"fGoodsData":[
				{
				"fGoodsId":'',
				"fGoodsName":'',
				"fAttrName1":'',
				"fAttrName2":'',
				"fAttrName3":'',
				"fAttrName4":'',
				"fNum":'',
				},
				{
				"fGoodsId":'',
				"fGoodsName":'',
				"fAttrName1":'',
				"fAttrName2":'',
				"fAttrName3":'',
				"fAttrName4":'',
				"fNum":'',					
				}
			]
		}
		"msg":"success"
	}
```

## 支付接口